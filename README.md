# Excelデータの列に含まれる区切り文字を排除する

Scivalから提供されるExcelデータに区切り文字が使用されていることが多い。<br>
例えば一つの論文の筆者3名の固有IDが、以下のような形式の値で格納されている。

例：`"10000 | 20000 | 300000"`

この状態で固有IDと別の情報をマージすることは困難であり、データ利用者はうまいこと区切り文字を処理してきた。今後同じような事態(車輪の再生産)を避けるために、今回は区切り文字を排除した上でExcelデータに再出力する、比較的汎用的なプログラムをPythonで書いた。<br>


## 使用方法
1. `key`,`target`という列名を含むExcelデータを用意する。`target`列には上記例のような区切り文字を、key列には区切り文字と紐づけたい情報を記載する。用意したデータは`./input`に格納。

    |  key  |  target  |
    | ---- | ---- |
    |  ronbun1  |  10000 \| 20000 \| 300000  |
    |  ronbun2  |  6543 \| 53 \| 45323  |

2. `rm_delimiter`を実行する。<br>
   ```
   python -m rm_delimiter
   ```

   UI画面上で区切り文字、input情報、output情報を指定し、「実行」を押下<br>
   区切り文字は"|",ファイルはサンプルデータを初期値に指定。
   
3. `./output`に出力結果が格納される

    |  key  |  target  |
    | ---- | ---- |
    |  ronbun1  |  10000  |
    |  ronbun1  |  20000  |
    |  ronbun1  |  300000 |
    |  ronbun2  |  6543   |
    |  ronbun2  |  53     |
    |  ronbun2  |  45323  |


## 備考
・pandasDataFrameをうまいこと取り回したつもりだが、もっと良い方法があるかも<br>
・Excel上でも実装可能だがTEXT関連関数のMS365必須等の条件が部署内の環境に合わない、かつVBAによるタコつぼ化を避けたかったので採用していない。